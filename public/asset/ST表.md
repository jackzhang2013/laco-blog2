# ST 表

## 定义

---

$f_{i,j}$ = 区间 $[i,i+2^j-1]$ 的最大值

> [!NOTE]
> **为什么是 $2^j-1$ 而不是 $2^j$ 呢**
>
> 因为需要支持区间长度为 $0$ 的情况。

## 实现

---

### 预处理求 $f_{i,j}$

- $f_{i,0}=a_i$
- $f_{i,j}=\max(f_{i,j-1},f_{i+2^{j-1},j-1})$

### 求区间最大值

1. 求出区间内最大的 $2^x$ 长度中的 $x$
2. 将区间分成两份：$[l,2^x-1]$，$[r-(2^x-1),r]$

   > [!NOTE]
   > **为什么要减$1$?**
   >
   > 因为 $f$ 中的 $j$ 代表 $2^j-1$

   两份分别对应 $f_{l,x}$ 和 $f_{r-(2^x-1),x}$
   对两份求 $\max$ 即可
