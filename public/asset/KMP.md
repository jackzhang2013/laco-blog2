# KMP

## 定义

---

$next_i$ = 到 $i$ 为止的字串真前缀与真后缀最大相同的前缀位置
$now$ = 当前已匹配个数
$cur$ = 模式串当前字符位置

## 过程

---

### 匹配模式串

- $now=0$
- $cur=1$

1. 检查主串 $cur$ 的位置与模式串 $now+1$ 的位置是否匹配
   - 如果匹配
      1. $now=now+1$
      2. $cur=cur+1$
   - 如果失配
      - 如果 $now \neq 0$
         $now=next_{now}$
      - 如果 $now=0$
         $cur=cur+1$
2. 重复执行步骤1，直到 $now$ 等于模式串长度或当前字符走到末尾

### 求 $next$

- $next_1=0$
- $now=0$
- $cur=1$

1. 检查主串 $cur+1$ 的位置与模式串 $now+1$ 的位置是否匹配
   - 如果匹配
      1. $next_{cur+1}=now+1$
      2. $now=now+1$
      3. $cur=cur+1$
   - 如果失配
      - 如果 $now \neq 0$
         $now=next_{now}$
      - 如果 $now=0$
      - $next_{cur+1}=0$
         $cur=cur+1$
2. 重复执行步骤1，直到 $now$ 等于模式串长度或当前字符走到末尾
