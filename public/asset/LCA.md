# LCA

## 定义

---

$fa_{u,i}$ = $u$ 的第 $2^{i}$ 个祖先
$dep_{u}$ = $u$ 的深度

## 过程

---

1. 调整两个节点到同一深度。
2. 一直往上跳转

## 实现

---

### 预处理求 $fa$

`dfs(u, father)`:

- $fa_{u,0} = father$
- $fa_{u,i} = fa_{fa_{u, i-1},i-1}$
- $dep_{0} = 0$
- $dep_{u} = dep_{father}+1$

### 求 $lca$

1. 交换 $u,v$ ，使 $dep_u < dep_v$
2. 通过将 $dep_v-dep_u$ 进行二进制拆分，将 $u$ 和 $v$ 向上跳跃到同一高度
3. 特判 $x=y$
4. 循环枚举 $i$ ，继续向上跳跃
